<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=API_KEY&sensor=true"></script>

<% if (session.authenticated) { %>
  <%- partial ('../navbar_loggedin.ejs') %>
  <% } else { %>
  <%- partial ('../navbar_loggedout.ejs') %>
  <% } %>

<div id="map-canvas"/>

<script>
var latitude, longitude, map, marker, markerLatitude, markerLongitude;

//Locate user and grab their latitude and longitude
$(document).ready(function() {
  navigator.geolocation.getCurrentPosition(function(position) {
  latitude = position.coords.latitude;
  longitude = position.coords.longitude;

  addMap();
  });
});

//Initialize the map and set its view to the user's location
var addMap = function() {
  var mapOptions = {
    center: new google.maps.LatLng(latitude, longitude),
    zoom: 12
  };
    map = new google.maps.Map(document.getElementById("map-canvas"),
      mapOptions);

    addMarkers();
  };

//Loop through inspirations and add a marker to the map for each inspiration
//at the location where it was added.
var addMarkers = function() {
  for (i = 0; i < <%= inspirations.length %>; i++) {
    markerLatitude = <%= (inspirations[i].latitude / 1000) %>
    markerLongitude = <%= (inspirations[i].longitude / 1000) %>
    marker = new google.maps.Marker({
      position: new google.maps.LatLng(markerLatitude, markerLongitude),
      title:"Hello World!"
    });

    marker.setMap(map);

  }
};



</script>
