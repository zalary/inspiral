<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=visualization&key=API_KEY&sensor=true"></script>

<% if (session.authenticated) { %>
  <%- partial ('../navbar_loggedin.ejs') %>
  <% } else { %>
  <%- partial ('../navbar_loggedout.ejs') %>
  <% } %>

<div id="map-canvas"/>

<script>
var latitude, longitude, map;
var heatmapData = [];

$(document).ready(function() {
  navigator.geolocation.getCurrentPosition(function(position) {
  latitude = position.coords.latitude;
  longitude = position.coords.longitude;

  console.log(<%= inspirations[0].latitude %>);

  addMap();
  });
});

var addMap = function() {
  var mapOptions = {
    center: new google.maps.LatLng(latitude, longitude),
    zoom: 12
  };
    map = new google.maps.Map(document.getElementById("map-canvas"),
      mapOptions);

    heatTheMap();
  };

  var heatTheMap = function() {
    for (i = 0; i < <%= inspirations.length %>; i++) {
    heatmapData.push({location: new google.maps.LatLng(<%= inspirations[i].latitude %>, <%= inspirations[i].longitude %>), weight: 1000}, new google.maps.LatLng(<%= inspirations[i].latitude %>, <%= inspirations[i].longitude %>))
    };

  var heatmap = new google.maps.visualization.HeatmapLayer({
    data: heatmapData
  });

  heatmap.setMap(map);
    };

</script>
